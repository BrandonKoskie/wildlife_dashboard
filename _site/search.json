[
  {
    "objectID": "wildlife_dashboard.html",
    "href": "wildlife_dashboard.html",
    "title": "wildlife_dashboard",
    "section": "",
    "text": "Code\nlibrary(ggplot2)\nlibrary(dplyr)\n\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\n\nCode\nlibrary(tidyverse)\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ lubridate 1.9.4     ✔ tibble    3.3.0\n✔ purrr     1.1.0     ✔ tidyr     1.3.1\n✔ readr     2.1.5     \n\n\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\n\nCode\nlibrary(lubridate)\nlibrary(janitor)\n\n\n\nAttaching package: 'janitor'\n\nThe following objects are masked from 'package:stats':\n\n    chisq.test, fisher.test\n\n\nCode\nlibrary(stringr)\nlibrary(leaflet)\n\n\nWarning: package 'leaflet' was built under R version 4.5.2\n\n\n\n\nCode\n# Load your dataset (adjust path if needed)\nmonk_injuries &lt;- read_csv(\"data/monk_injuries.csv\")\n\n\nRows: 192 Columns: 12\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (12): Date, Location, Hooknet, Death, Seal_Size_Sex_ID, Description, Sou...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\n\nCode\nmonk_injuries &lt;- monk_injuries %&gt;% clean_names()  # converts all column names to snake_case\n\n\n\n\nCode\nmonk_injuries &lt;- monk_injuries %&gt;%\n  mutate(\n    hooknet = factor(hooknet),\n    seriousness_for_sar = factor(seriousness_for_sar),\n    death = factor(death)\n  )\n\n\n\n\nCode\nmonk_injuries &lt;- monk_injuries %&gt;%\n  mutate(\n    date_final = mdy(date),\n    year = year(date_final)\n  )\n\n\n\n\nCode\ninjuries_per_year &lt;- monk_injuries %&gt;%\n  group_by(year) %&gt;%\n  summarise(n_injuries = n())\n\n\n\n\nCode\nggplot(injuries_per_year, aes(x = year, y = n_injuries)) +\n  geom_line(color = \"steelblue\", linewidth = 1.2) +\n  geom_point(color = \"darkred\", size = 3) +\n  labs(\n    title = \"Timeline of Monk Seal Injuries\",\n    x = \"Year\",\n    y = \"Number of Injuries\"\n  ) +\n  theme_minimal()\n\n\nWarning: Removed 1 row containing missing values or values outside the scale range\n(`geom_line()`).\n\n\nWarning: Removed 1 row containing missing values or values outside the scale range\n(`geom_point()`).\n\n\n\n\n\n\n\n\n\n\n\nCode\n# Extract sex\nmonk_injuries &lt;- monk_injuries %&gt;%\n  mutate(sex = case_when(\n    str_detect(seal_size_sex_id, \"M\") ~ \"Male\",\n    str_detect(seal_size_sex_id, \"F\") ~ \"Female\",\n    TRUE ~ \"Unknown\"\n  ))\n\n# Count + percentage\nsex_summary &lt;- monk_injuries %&gt;%\n  group_by(sex) %&gt;%\n  summarise(n = n()) %&gt;%\n  mutate(\n    percent = round(n / sum(n) * 100, 1),\n    label = paste0(sex, \"\\n\", n, \" seals\\n\", percent, \"%\")\n  )\n\n# Pie chart\nggplot(sex_summary, aes(x = \"\", y = percent, fill = sex)) +\n  geom_col(width = 1, color = \"white\") +\n  coord_polar(theta = \"y\") +\n  geom_label(\n    aes(label = label),\n    position = position_stack(vjust = 0.5),\n    color = \"black\",\n    fill = \"white\",\n    size = 4,\n    label.size = 0\n  ) +\n  labs(title = \"Sex Distribution of Monk Seal Injuries\") +\n  theme_void() +\n  scale_fill_manual(values = c(\n    \"Male\" = \"lightblue\",\n    \"Female\" = \"pink\",\n    \"Unknown\" = \"gray\"\n  ))\n\n\nWarning: The `label.size` argument of `geom_label()` is deprecated as of ggplot2 3.5.0.\nℹ Please use the `linewidth` argument instead.\n\n\n\n\n\n\n\n\n\n\n\nCode\nmonk_injuries &lt;- monk_injuries %&gt;%\n  mutate(island = case_when(\n    str_detect(location, regex(\"Kauai\", ignore_case = TRUE)) ~ \"Kauai\",\n    str_detect(location, regex(\"Oahu\", ignore_case = TRUE)) ~ \"Oahu\",\n    str_detect(location, regex(\"Molokai\", ignore_case = TRUE)) ~ \"Molokai\",\n    str_detect(location, regex(\"Lanai\", ignore_case = TRUE)) ~ \"Lanai\",\n    str_detect(location, regex(\"Maui\", ignore_case = TRUE)) ~ \"Maui\",\n    str_detect(location, regex(\"Hawaii|Big Island|Mahukona|Puako|Lapakahi|South Point\", ignore_case = TRUE)) ~ \"Hawaii\",\n    \n    # NWHI\n    str_detect(location, regex(\"Kure\", ignore_case = TRUE)) ~ \"Kure\",\n    str_detect(location, regex(\"Laysan\", ignore_case = TRUE)) ~ \"Laysan\",\n    str_detect(location, regex(\"Necker\", ignore_case = TRUE)) ~ \"Necker\",\n    str_detect(location, regex(\"FFS|French Frigate\", ignore_case = TRUE)) ~ \"French Frigate Shoals\",\n    str_detect(location, regex(\"Kahoolawe\", ignore_case = TRUE)) ~ \"Kahoolawe\",\n    \n    # Pelagic / offshore / unknown island\n    str_detect(location, regex(\"pelagic|location TBD|unknown\", ignore_case = TRUE)) ~ \"Offshore / Unknown\",\n    \n    TRUE ~ \"Unknown\"\n  ))\n\n\n\n\nCode\n#Island latitude/longitude lookup table\nisland_coords &lt;- tribble(\n  ~island,                     ~lat,      ~lon,\n  \"Kauai\",                     22.0964,  -159.5261,\n  \"Oahu\",                      21.4389,  -158.0001,\n  \"Molokai\",                   21.144,   -157.022,\n  \"Lanai\",                     20.827,   -156.925,\n  \"Maui\",                      20.7984,  -156.3319,\n  \"Hawaii\",                    19.5429,  -155.6659,\n  \"Kure\",                      28.4167,  -178.3333,\n  \"Laysan\",                    25.7667,  -171.7333,\n  \"Necker\",                    23.5667,  -164.7000,\n  \"French Frigate Shoals\",     23.8667,  -166.2833,\n  \"Kahoolawe\",                 20.5469,  -156.6019,\n  \"Offshore / Unknown\",        NA,       NA,\n  \"Unknown\",                   NA,       NA\n)\n\n#Aggregate total injuries per island\nisland_summary &lt;- monk_injuries %&gt;%\n  group_by(island) %&gt;%\n  summarise(total_injuries_island = n(), .groups = \"drop\")\n\n#Join coordinates into dataset\nmonk_map &lt;- monk_injuries %&gt;%\n  left_join(island_coords, by = \"island\") %&gt;%\n  left_join(island_summary, by = \"island\") %&gt;%\n  filter(!is.na(lat))  # drop unknown island points\n\n#Build the interactive map\nleaflet(monk_map) %&gt;%\n  addTiles() %&gt;%\n  addCircleMarkers(\n    lng = ~lon,\n    lat = ~lat,\n    radius = 5,\n    color = \"red\",\n    stroke = TRUE,\n    fillOpacity = 0.7,\n    popup = ~paste0(\n      \"&lt;b&gt;Island:&lt;/b&gt; \", island, \"&lt;br&gt;\",\n      \"&lt;b&gt;Total injuries:&lt;/b&gt; \", total_injuries_island\n    )\n  ) %&gt;%\n  addLegend(\"bottomright\", colors = \"red\", labels = \"Injury Reports\")"
  }
]